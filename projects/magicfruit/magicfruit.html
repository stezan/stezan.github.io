<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Una Sorpresa para Marcelita</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Pacifico&family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        /* Use a custom font for the title to make it special */
        .font-pacifico {
            font-family: 'Pacifico', cursive;
        }
        /* Use Inter as the base font */
        body {
            font-family: 'Inter', sans-serif;
        }

        /* Styling for the wheel and its components */
        .wheel-container {
            position: relative;
            width: 90vw;
            height: 90vw;
            max-width: 500px;
            max-height: 500px;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .wheel {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            position: relative;
            overflow: hidden;
            border: 8px solid #fef3c7; /* A nice, creamy border */
            box-shadow: 0 10px 20px rgba(0,0,0,0.1), 0 6px 6px rgba(0,0,0,0.15);
            /* This transition creates the spinning animation */
            transition: transform 5s cubic-bezier(0.25, 0.1, 0.25, 1);
        }

        /* The pointer that indicates the winning slice */
        .pointer {
            position: absolute;
            top: -15px;
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 0;
            border-left: 25px solid transparent;
            border-right: 25px solid transparent;
            border-top: 40px solid #ef4444; /* A bright red color */
            z-index: 10;
            filter: drop-shadow(0 2px 2px rgba(0,0,0,0.3));
        }

        /* Styling for each slice of the wheel */
        .slice {
            position: absolute;
            width: 50%;
            height: 100%;
            transform-origin: 100% 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            padding-right: 22%; /* Adjusted to better center text in the wedge */
            box-sizing: border-box;
            writing-mode: vertical-rl;
            text-orientation: mixed;
            transform: rotate(var(--rotation));
            /* This clip-path creates a proper wedge for a 5-slice wheel (72deg per slice) */
            clip-path: polygon(100% 50%, 0 13.7%, 0 86.3%);
        }
        
        .slice .text {
             transform: rotate(180deg);
             font-weight: 600;
             font-size: clamp(1rem, 4vw, 1.5rem);
             color: white;
             text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
        }

        /* Center spinner for decoration */
        .wheel-center {
            position: absolute;
            width: 15%;
            height: 15%;
            background: #fef3c7;
            border-radius: 50%;
            border: 5px solid #ca8a04;
            z-index: 5;
        }
    </style>
</head>
<body class="bg-amber-50 text-gray-800 flex flex-col items-center justify-center min-h-screen p-4">

    <!-- Main Title -->
    <header class="text-center mb-8">
        <h1 class="font-pacifico text-5xl md:text-7xl text-rose-500">Para mi Marcelita ‚ù§Ô∏è</h1>
        <p class="text-xl text-amber-700 mt-2">Gira la rueda de la fortuna</p>
    </header>

    <!-- Wheel of Fortune Container -->
    <main class="flex flex-col items-center">
        <div class="wheel-container">
            <div class="pointer"></div>
            <div id="wheel" class="wheel">
                <!-- Slices are generated by JavaScript -->
            </div>
            <div class="wheel-center"></div>
        </div>
        
        <!-- Spin Button -->
        <button id="spin-button" class="mt-8 px-10 py-4 bg-red-500 text-white text-2xl font-bold rounded-full shadow-lg hover:bg-red-600 active:bg-red-700 transform hover:scale-105 transition-all duration-200 disabled:bg-gray-400 disabled:cursor-not-allowed disabled:scale-100">
            ¬°GIRAR!
        </button>
    </main>

    <!-- Modal Dialog for the Winner -->
    <div id="modal" class="fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center p-4 z-50 hidden transition-opacity duration-300">
        <div class="bg-white rounded-2xl shadow-2xl p-8 text-center max-w-sm w-full transform scale-95 transition-transform duration-300">
            <span class="text-7xl">üéâ</span>
            <h2 class="text-3xl font-bold text-gray-800 mt-4">¬°Felicidades, Marcelita!</h2>
            <p class="text-5xl font-bold my-4 text-emerald-600">Ganaste una Guan√°bana</p>
            <p class="text-gray-600">¬°Espero que te guste tu premio! ü•≥</p>
            <button id="close-modal" class="mt-6 px-6 py-2 bg-rose-500 text-white rounded-lg hover:bg-rose-600 transition">Cerrar</button>
        </div>
    </div>

    <script>
        // --- Configuration ---
        const fruits = ['Mango', 'Manzana', 'Higo', 'Guanabana', 'Chirimoya'];
        const colors = ['#f59e0b', '#10b981', '#8b5cf6', '#3b82f6', '#ec4899'];
        const targetFruit = 'Guanabana'; // The fruit that will always win
        const spinDuration = 5000; // 5 seconds for the spin animation

        // --- DOM Elements ---
        const wheel = document.getElementById('wheel');
        const spinButton = document.getElementById('spin-button');
        const modal = document.getElementById('modal');
        const closeModalButton = document.getElementById('close-modal');

        // --- State ---
        let isSpinning = false;
        let totalRotation = 0; // Tracks the cumulative rotation of the wheel
        const sliceAngle = 360 / fruits.length;

        // --- Functions ---

        /**
         * Create and append the wheel slices to the DOM
         */
        function createSlices() {
            fruits.forEach((fruit, i) => {
                const rotation = sliceAngle * i;
                const slice = document.createElement('div');
                slice.className = 'slice';
                slice.style.setProperty('--rotation', `${rotation}deg`);
                slice.style.backgroundColor = colors[i % colors.length];

                const text = document.createElement('span');
                text.className = 'text';
                text.textContent = fruit;
                slice.appendChild(text);

                wheel.appendChild(slice);
            });
        }
        
        /**
         * Handles the spinning logic
         */
        function spinWheel() {
            if (isSpinning) {
                return; // Don't spin if already spinning
            }
            isSpinning = true;
            spinButton.disabled = true;

            // 1. Calculate the target angle offset
            const targetIndex = fruits.indexOf(targetFruit);
            // The pointer is at the top (270deg in CSS rotation). We calculate the offset
            // needed to align the center of the target slice with the pointer.
            const targetAngleOffset = 270 - (targetIndex * sliceAngle + sliceAngle / 2) - 170;
            
            // 2. Add random full rotations for effect
            const randomRotations = (Math.floor(Math.random() * 4) + 4) * 360;
            
            // 3. Calculate the final rotation value
            // We ensure the wheel always spins forward by finding the next highest full-circle
            // rotation and then adding the new random spins and the target offset.
            totalRotation = Math.ceil(totalRotation / 360) * 360;
            totalRotation += randomRotations;
            const finalRotation = totalRotation + targetAngleOffset;

            // 4. Apply the rotation to the wheel
            wheel.style.transform = `rotate(${finalRotation}deg)`;
            
            // 5. Store the final rotation for the next spin
            totalRotation = finalRotation;

            // 6. After the animation, show the result
            setTimeout(() => {
                modal.classList.remove('hidden');
                // A little effect to make the modal pop
                setTimeout(() => modal.querySelector('div').style.transform = 'scale(1)', 10);
                spinButton.disabled = false;
                isSpinning = false;
            }, spinDuration);
        }

        /**
         * Hides the winner modal
         */
        function hideModal() {
            modal.querySelector('div').style.transform = 'scale(0.95)';
            modal.classList.add('hidden');
        }

        // --- Event Listeners ---
        spinButton.addEventListener('click', spinWheel);
        closeModalButton.addEventListener('click', hideModal);
        modal.addEventListener('click', (e) => {
            // Close modal if the dark background is clicked
            if (e.target === modal) {
                hideModal();
            }
        });

        // --- Initialization ---
        // Create the wheel slices when the page loads
        createSlices();

    </script>
</body>
</html>

